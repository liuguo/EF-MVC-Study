
@model IEnumerable<efef.Models.SysUser>

@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Index</title>
    <script src="~/Scrript/jquery-1.10.2.js"></script>
    <script src="~/Scrript/jquery-1.10.2.min.js"></script>
    <script type="text/javascript">
        @*$(function () {
            $("#bt1").click(function () {
                var tvalue = $("#txt1").val();
                var parms = "searchString=" + tvalue+ "&id=" + '@ViewBag.PageIndex' + "&sortOrder=" ;
                if (!('@ViewBag.NameSortParm')) {
                }
                else {
                    parms = "searchString=" + tvalue + "&id=" + '@ViewBag.PageIndex' + "&sortOrder=" + '@ViewBag.NameSortParm';
                }

                $.ajax({
                    type: "GET",
                    url: "/Account/Sort",
                    data: parms,
                    success: function (data) {

                        var json = eval(data);
                        $.each(json, function (index, item) {
                            //循环获取数据
                            var UserName = json[index].UserName;
                            var Email = json[index].Email;
                            var Password = json[index].Password;
                            $("#list").html($("#list").html() + "<br>" + "UserName:" + UserName + " - " + "Email:" + Email + " - " + "Password:" + Password + "<br/>");
                        });
                    }
                });

            });
        });*@


        $(function () {
            $("#bt1").click(function () {
                func();
                //var tvalue = $("#txt1").val();
                //var v = document.getElementById("ppp").innerText;

                // alert(document.getElementById("ppp").innerText);

                //var parms = "searchString=" + tvalue + "&id=1"+ "&sortOrder=";
                //if (!v) {
                //}
                //else {
                //    parms = "searchString=" + tvalue + "&id=1" + "&sortOrder=" + v;
                //}

                //$.ajax({
                //    type: "GET",
                //    url: "/Account/Sort",
                //    data: parms,
                //    success: function (data) {
                //        var json = eval(data);
                //        var NameSortParm = json.NameSortParm;
                //        var x = document.getElementById("ppp");
                //        x.innerHTML = NameSortParm;
                //        清空原有数据
                //        $("#tbody").text("");
                //        $.each(json.data, function (index, item) {
                //            循环获取数据
                //            var dataid = json.data[index].ID;
                //            var UserName = json.data[index].UserName;
                //            var Email = json.data[index].Email;
                //            var Password = json.data[index].Password;
                //            $("#tbody").html($("#tbody").html() + "<tr>" + "<td>" + UserName + "</td>" + "<td>" + Email + "</td>" + "<td>" + Password + "</td>" + "</tr>");
                //        });
                //    }
                //});

            });
        });

        function func() {
            var tvalue = $("#txt1").val();
            var v = document.getElementById("ppp").innerText;
            var pageindex = document.getElementById("pageIndex").innerText;


            parms = "searchString=" + tvalue ;
            if (!pageindex) {
                parms = parms + "&id=";
            }
            else {
                parms = parms + "&id=" + pageindex;
            }
            if (!v) {
                parms = parms + "&sortOrder=";
            }
            else {
                parms= parms + "&sortOrder=" + v;
            }

            $.ajax({
                type: "GET",
                url: "/Account/SearchString",
                data: parms,
                success: function (data) {
                    var json = eval(data);
                    var NameSortParm = json.NameSortParm;

                    var x = document.getElementById("ppp");
                    x.innerHTML = NameSortParm;

                    var pageI = document.getElementById("pageIndex");
                    pageI.innerHTML = json.pageIndex;
                    //清空原有数据
                    $("#tbody").text("");
                    $.each(json.data, function (index, item) {
                        //循环获取数据
                        var dataid=json.data[index].ID;
                        var UserName = json.data[index].UserName;
                        var Email = json.data[index].Email;
                        var Password = json.data[index].Password;
                        $("#tbody").html($("#tbody").html() +"<tr>"  +"<td>"+UserName+"</td>"+"<td>"+Email+"</td>"+"<td>"+Password+"</td>"+ "</tr>");
                    });
                }
            });
        }

        $(function () {
            $("#sort").click(function () {
                func();
            });
        });

    </script>

</head>
<body>
    <div>
        <ul id="list"></ul> 
     </div>
   
    <div class="col-md-12 col-sm-12 col-xs-12">
        <div class="x_panel">
            <div class="x_content">
                <p class="sub-header"> @Html.ActionLink("Create New", "Create")</p>
                <p id="ppp"></p>
                <p id="pageIndex"> @ViewBag.PageIndex </p>
             <p>
                 Search By Name:<input type="text" id="txt1" name="txt1" />
                 <input id="bt1" type="button" value="Search"/>
             </p>
   
                <table id="datatable" class="table table-striped table-bordered">
                    <thead>
                        <tr>
                            <th >@Html.DisplayNameFor(model => model.UserName)<img id="sort" src="~/Boostrop/production/images/bitbug_favicon.ico" /></th>
                            <th >@Html.DisplayNameFor(model => model.Email)</th>
                            <th ><p>option</p></th>
                        </tr>
                    </thead>
                    <tbody id="tbody">



                        @foreach (var item in Model)
                        {


                            <tr>
                                <td>@Html.DisplayFor(modelitem => item.UserName)</td>
                                <td>@Html.DisplayFor(modelitem => item.Email)</td>
                                <td>
                                    @Html.ActionLink("Details", "Details", new { id = item.ID })
                                    @Html.ActionLink("Edit", "Edit", new { id = item.ID })
                                    @Html.ActionLink("Delete", "Delete", new { id = item.ID })
                                </td>

                            </tr>
                        }

                    </tbody>
                </table>
                <p>当前第 @ViewBag.PageIndex 页，共 @ViewBag.TotalPage页共 @ViewBag.Total 条数据NameSortParm: @ViewBag.NameSortParm</p>
                <ul class="pager">
                    @{
                        int j = @ViewBag.PageIndex;
                        int pageup = j - 1;
                        int pagenext = j + 1;
                    }
                    @if (@ViewBag.PageIndex <= 1)
            {

            }
            else {
                        <li><a id="myId" href="/Account/fenye?i=@pageup">Previous</a></li>
                    }

                    @if (@ViewBag.PageIndex >= 5)
            {

            }
                    @for (int i = 1; i <= ViewBag.TotalPage; i++)
            {
                        <li><a href="/Account/fenye?i=@i">@i</a></li>
                    }

                    @if (@ViewBag.PageIndex >= @ViewBag.TotalPage)
            {

            }
            else {
                        <li><a href="/Account/fenye?i=@pagenext">Next</a></li>
                    }
                </ul>
            </div>
        </div>
    </div>
    <h1>通过@@html.partial来使用</h1>
    @Html.Partial("~/Views/Shared/_Partialwidget.cshtml");
    <h1>通过@@html.RenderPartial来使用</h1>
    @{

        Html.RenderPartial("~/Views/Shared/_Partialwidget.cshtml");
    }

</body>

</html>
